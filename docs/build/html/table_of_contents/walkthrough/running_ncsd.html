

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NCSD &mdash; NPSM 0.0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Raising/Lowering" href="running_raising_lowering.html" />
    <link rel="prev" title="The Basics" href="the_basics.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> NPSM
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="walkthrough.html">Walkthrough</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="the_basics.html">The Basics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NCSD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#important-variables">Important Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-ncsd">Running NCSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-ncsd-output">Plotting NCSD Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_raising_lowering.html">Raising/Lowering</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_trdens.html">TRDENS</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_ncsmc.html">NCSMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_cross_sections.html">Cross-Sections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ncsd_python/ncsd_python.html">ncsd_python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../raising_lowering/raising_lowering.html">raising_lowering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trdens_python/trdens_python.html">trdens_python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ncsmc_python/ncsmc_python.html">ncsmc_python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross_sections/cross_sections.html">cross_sections</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NPSM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="walkthrough.html">Walkthrough</a> &raquo;</li>
        
      <li>NCSD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/table_of_contents/walkthrough/running_ncsd.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ncsd">
<h1>NCSD<a class="headerlink" href="#ncsd" title="Permalink to this headline">¶</a></h1>
<p>The ncsd_python module makes it easy to run NCSD multiple times
and to plot output from those NCSD runs.</p>
<div class="section" id="important-variables">
<h2>Important Variables<a class="headerlink" href="#important-variables" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>ncsd_path:</dt><dd><p>Path to NCSD executable</p>
</dd>
<dt>working_dir:</dt><dd><p>Path to directory where you want to put all the ncsd files and run them</p>
</dd>
<dt>int_dir:</dt><dd><p>Path to directory where your interaction files are stored</p>
</dd>
<dt>machine:</dt><dd><p>One of “cedar”, “summit”, “local”. The machine you’re using to run ncsd.</p>
</dd>
<dt>run:</dt><dd><p>Do you want to run the batch files this code creates? If so, set run=True</p>
</dd>
<dt>ZN:</dt><dd><p>Pairs of Z, N values, e.g. (3, 5) or [(3, 5), (3, 6)].</p>
</dd>
<dt>hbar_omega:</dt><dd><p>Harmonic oscillator frequency</p>
</dd>
<dt>N_1max:</dt><dd><p>highest number of harmonic oscillator quanta for 1 nucleon</p>
</dd>
<dt>N_12max:</dt><dd><p>highest number of harmonic oscillator quanta for 2 nucleons</p>
</dd>
<dt>Nmax:</dt><dd><p>This isn’t a parameter you’ll have to enter here, but you should know what
<code class="docutils literal notranslate"><span class="pre">Nmax</span></code> is. In contrast to <code class="docutils literal notranslate"><span class="pre">N_1max</span></code> and <code class="docutils literal notranslate"><span class="pre">N_12max</span></code>,
<code class="docutils literal notranslate"><span class="pre">Nmax</span></code> is the maximum number of oscillator quanta allowed above the
lowest Pauli-allowed state for the nucleus of interest.
E.g., <code class="docutils literal notranslate"><span class="pre">Nmax</span> <span class="pre">=</span> <span class="pre">0</span></code> is the ground state of a nucleus.</p>
</dd>
<dt>Nmax_min, Nmax_max:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Nmax_min</span></code> and <code class="docutils literal notranslate"><span class="pre">Nmax_max</span></code> are lower/upper bounds for <code class="docutils literal notranslate"><span class="pre">Nmax</span></code>.
For example, <code class="docutils literal notranslate"><span class="pre">Nmax_min</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">Nmax_max</span> <span class="pre">=</span> <span class="pre">8</span></code> gives eigenvectors for
<code class="docutils literal notranslate"><span class="pre">Nmax</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">8</span></code>.</p>
</dd>
<dt>Nmax_IT:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Nmax</span></code> value at which importance truncation starts</p>
</dd>
<dt>n_states:</dt><dd><p>number of final states of the nucleus that we want to calculate</p>
</dd>
<dt>iterations_required:</dt><dd><p>At some point in the calculation, we have to diagonalize the hamiltonian,
which is a huge matrix, so we have to approximate using the Lanczos
algorithm. <code class="docutils literal notranslate"><span class="pre">iterations_required</span></code> is the number of steps to use during
this Lanczos step.</p>
</dd>
<dt>irest:</dt><dd><p>If the calculation fails, should we restart?
4 = yes, 0 = no, and there are a couple more options too.</p>
</dd>
<dt>nhw_restart:</dt><dd><p>Either -1 or 1, whether to restart the calculation using partially finished
data from a previous run</p>
</dd>
<dt>kappa:</dt><dd><p>Kappa is a value that’s used for TODO: what?</p>
</dd>
<dt>kappa_points:</dt><dd><p>The number of kappa values to use.
Note that they are entered here such that 1 means 1x10-4.</p>
</dd>
<dt>kappa_vals:</dt><dd><p>The values for kappa in increasing order, written as a string so as not
to confuse the program by giving it a list and looping over the values.</p>
</dd>
<dt>kappa_restart:</dt><dd><p>Whether or not to restart the calculation with a certain value of kappa.
-1 for false, or else some value between 1 and 4.</p>
</dd>
<dt>saved_pivot:</dt><dd><p>“T” or “F”, whether or not to use a pivot saved during the Lanczos step
of a previous run.</p>
</dd>
<dt>time:</dt><dd><p>A string of the form “days hours minutes”, that tells how much processor
time to reserve. This string will be formatted properly later by the
program, depending on which machine you’re using.</p>
</dd>
<dt>mem:</dt><dd><p>How much memory will you need? Integer, denotes memory in GB.</p>
</dd>
<dt>n_nodes:</dt><dd><p>number of nodes (integer)</p>
</dd>
<dt>potential_name:</dt><dd><p>The name of the potential you used for your interaction,
for example, “n3lo-NN3Nlnl-srg2.0”.
This is used as an identifier for output files.</p>
</dd>
<dt>two_body_interaction:</dt><dd><p>The name of a 2-body interaction file, e.g.
“TBMEA2srg-n3lo2.0_14.20_910”.
Note that this file must be stored inside int_dir!</p>
</dd>
<dt>interaction_type:</dt><dd><p>Integer that designates which type of interaction.
2 means 2-body, 3 means 3-body, -3 means 3-body but only 2-body
when doing the importance truncated steps.</p>
</dd>
<dt>N_123max:</dt><dd><p>ighest number of harmonic oscillator quanta for 3 nucleons</p>
</dd>
<dt>three_body_interaction:</dt><dd><p>The name of a 3-body interaction file, e.g.
“v3trans_J3T3.int_3NFlocnonloc-srg2.0_from24_220_11109.20_comp”.
Note that this file must be stored inside int_dir!</p>
</dd>
</dl>
</div>
<div class="section" id="running-ncsd">
<h2>Running NCSD<a class="headerlink" href="#running-ncsd" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">ncsd_python</span></code> directory, and the <code class="docutils literal notranslate"><span class="pre">ncsd_multi.py</span></code> file within.</p></li>
<li><p>Adjust all the parameters near the top as needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ncsd_path</span> <span class="o">=</span> <span class="n">realpath</span><span class="p">(</span><span class="s2">&quot;ncsd-it.exe&quot;</span><span class="p">)</span>
<span class="n">working_dir</span> <span class="o">=</span> <span class="n">realpath</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">int_dir</span> <span class="o">=</span> <span class="n">realpath</span><span class="p">(</span><span class="s2">&quot;../interactions/&quot;</span><span class="p">)</span>
<span class="n">machine</span> <span class="o">=</span> <span class="s2">&quot;cedar&quot;</span>
<span class="n">run</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">man_params</span> <span class="o">=</span> <span class="n">ManParams</span><span class="p">(</span>
    <span class="n">Z</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># number of protons</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># number of neutrons</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Enter the necessary paths</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">machine</span></code> should be either <code class="docutils literal notranslate"><span class="pre">cedar</span></code>, <code class="docutils literal notranslate"><span class="pre">summit</span></code>, or <code class="docutils literal notranslate"><span class="pre">local</span></code>
(or some other machine if you add a way to make batch files for it)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run</span></code> controls whether or not to run all batch files automatically
at the end of this script</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ManParams</span></code> instance is where you put nucleus info, etc.</p></li>
<li><p>Inside <code class="docutils literal notranslate"><span class="pre">ncsd_multi.py</span></code>, each parameter is further explained in a comment</p></li>
</ul>
<p>For example, to do an NCSD run for lithium 6, 7, 8, and 9, enter this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">man_params</span> <span class="o">=</span> <span class="n">ManParams</span><span class="p">(</span>
    <span class="n">Z</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># number of protons</span>
    <span class="n">N</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>  <span class="c1"># number of neutrons</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Run the file, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">ncsd_multi</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The script will…</p>
<ul class="simple">
<li><p>create a directory for each run</p></li>
<li><p>put all the necessary files (e.g. mfdp.dat) inside</p></li>
<li><p>depending on the value of <code class="docutils literal notranslate"><span class="pre">run</span></code>, it will submit the jobs</p></li>
<li><p>once ncsd’s done running all output will be plotted</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="plotting-ncsd-output">
<h2>Plotting NCSD Output<a class="headerlink" href="#plotting-ncsd-output" title="Permalink to this headline">¶</a></h2>
<p>Now you have ncsd output files, and you want to make a plot
of energies vs Nmax. Something like this:</p>
<a href="https://i.imgur.com/nw1HBUW.png" >
    <img src="https://i.imgur.com/nw1HBUW.png"/>
</a><p>The file containing the relevant output will have a name like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Li8_n3lo</span><span class="o">-</span><span class="n">NN3Nlnl</span><span class="o">-</span><span class="n">srg2</span><span class="o">.</span><span class="mi">0</span><span class="n">_Nmax0</span><span class="o">-</span><span class="mf">10.20</span>
</pre></div>
</div>
<p>The script <code class="docutils literal notranslate"><span class="pre">output_plotter.py</span></code> will read that file, then plot the energies
of the states it finds. It produces .grdt, .csv, .png, and .svg output files.</p>
<p>The image I showed above is just the auto-generated matplotlib plot,
which could use some work in terms of beauty. If you want to edit the plots
afterwards, e.g. to rearrange titles, either use the xmgrace files or
edit the .svg file with Inkscape or a similar program.</p>
<p>If you want your plot to exclude certain <code class="docutils literal notranslate"><span class="pre">Nmax</span></code> values or something,
there are parameters in the <code class="docutils literal notranslate"><span class="pre">output_plotter.py</span></code> file that you can edit,
and then re-run. Those parameters are better explained inside the actual file.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="running_raising_lowering.html" class="btn btn-neutral float-right" title="Raising/Lowering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="the_basics.html" class="btn btn-neutral float-left" title="The Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Callum McCracken

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>